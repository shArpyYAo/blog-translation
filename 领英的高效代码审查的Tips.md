# 领英的高效代码审查的Tips


##### By [Szczepan Faber](https://thenewstack.io/author/szczepan-faber/) | Sep 27, 2017

[原文](https://thenewstack.io/linkedin-code-review/)

领英最近达成了进行一百万次代码审查的里程碑。社交网络服务工具负责人在此过程中分享了一些经验教训。
阅读和审查代码是每位程序员每天都做的事情。然而，正式的代码审查却有点不一样——一位成员每次代码提交并上生产环境前
都需要被另外一位团队成员正式的审查。在领英，从2011年开始代码审查就已经是开发流程中的一个强制执行的部分。
我们进行代码审查的目的是为了尽可能平稳地扩大我们快速发展的工程团队。有着有意义、有用的评论的好的代码审查会帮助整个工程团队
提升开发水平。在领英，代码审查已经变成了代码质量保证和知识分享的必要部分。拥抱代码审查已经在几个关键方面更好德改变了我们的工程文化。

实施公司范围内的代码审查的最大好处之一就是提高了我们开发流程中的标准化程度。在领英，所有的开发团队都用同样的工具和程序
进行代码审查，这意味着任何一个人都可以为任何项目审查和贡献代码。这消除了像“我可以帮助修复他们代码的bug，但是我要
怎么构建并提交这次修复呢？”这样的问题，反过来，也可以促进不同开发团队的合作。

通过强制执行代码审查，我们还帮助公司建立了健康的反馈文化：工程师乐于接受和接受所有工作领域的反馈，而不仅仅是在编码方面，
因为它已成为工作的日常工作。我们的工程师比起把代码审查看作挑剔且消极的事，更愿意把代码审查当作提升专业能力的机会。
实际上，高质量的代码审查是领英评审晋升程序的重要组成部分，因为它们可以提供客观的工程技能证据。

多年以来，我们实践出几个代码审查的最佳实践和Tips。以下是一些形式为问题的准则，建议您提出一些问题，
以帮助确保审阅者和受审者从代码审阅中获得最大的价值。

## 我真的了解“为什么”？

为了尽可能提升审查效率和质量并且帮助团队成员评测，所有代码在提交前应该包含简洁说明了修改代码的动机的设计概要。
当需要通过代码本身推断修改动机时，很难提供高质量的代码审查。在参与代码审查前，要求提交者说出或提供（文档形式）修改动机是很合理的。
这也鼓励了提交者写好自己的commit message（译者注：git的message），提高代码文档（译者注：应该是代码提交树的message）的质量。

## 我给了正向的回馈吗？

在团队里面都是大佬的时候，干净的代码和高的测试覆盖率是理所当然的。结果，代码审查的反馈倾向于关注代码里的问题和议题。
这是非常不幸的，因为大多数人需要积极的反馈才能感到投入和动力—工程师也不例外。当审查者看到代码里不错的实现，
他应该指出来并且给出正向的反馈。这有助于提高团队进行代码审查的动力，并且正向反馈导致的情绪是会传染给其他人的。
与所有代码审阅评论一样（请参见下文），任何肯定的反馈都应是具体的，并解释为什么写的好。

## 我给出的评论说的够好吗？

无论反馈是肯定的还是否定的，任何代码审查的评论的意思都应不言自明。可能对于审查者来说他写的评论意思显而易见，但是对于代码作者却是不清楚的。
如有疑问，最好进行过度解释，而不是提供简短的反馈，以产生更多的问题以及需要更多的来回沟通。
评论可以很简单，例如“减少重复”，“提高覆盖率”或“使代码更易于测试”。
除了使评论者的评论更清晰外，这些类型的解释还有助于加强团队渴望达到的设计原则。
	
## 我赞赏提交者的努力吗？

无论结果如何，总需要赞赏他们的辛苦工作-这会培养出强大而积极进取的团队。有些代码变更质量不高并且需要重构，在这种情况下，
即使他们的代码需要重构，仍然必须承认作者所做的更改非常重要。表示赞赏的最好方法是通过提供高质量的反馈并提供体面的解释，
找到好代码（每次提交的代码中总有好东西！），并使用“谢谢”。
	
## 审查的评论对我有用吗？

提出这个问题是验证代码审查的评论是否必要的一种简单而有效的方法。归根结底，工程师应该将代码审查视为有用的开发工具，
而不是无关紧要的工作来源。如果你觉得有些评论没有用处，那就删了它。一个典型的无用的评论是与代码格式相关的。
代码样式和格式应由自动化工具而非工程师验证。
![](https://storage.googleapis.com/cdn.thenewstack.io/media/2017/09/efa28730-codereviews.png)

## “测试完成”部分是否足够？

在领英，每个代码提交都必须填写“测试完成”部分。在开源世界，以github为例，
工程师都会在PR（译者注：github的pull request）的描述写上“测试完成”。“测试完成”应该做什么取决于更改的严重性和当前测试范围。
如果更改包含新的或更改的条件复杂度，则可以公平地期望它包含在单元测试中（译者注：这句没看懂）。
如果集成测试的覆盖范围不足，则某些更改可能需要运行手动测试。在这些情况下，“测试完成”应该包含测试用例和输出。
当改变程序输出时，将新的输出包括在“测试完成”部分中非常有用。

## 我的评论是否表现出我太学究、太卖弄学问（Pedantic）了

一些代码评审的评论太多，以至于重要的问题（实际上是需要解决的问题）在次要的建议中丢失了。
对于给定团队而言，过于详细的评论可能会减慢审阅周期，并给审阅者和受审者造成摩擦。
拥有清晰的评审期望，示例评审以及积极，有魅力的评审文化是避免冗长而费力的评审周期的好方法。

总之，进行正式的代码审查过程有助于提高代码质量，团队学习和知识共享。
当团队中的每个工程师都意识到两件重要的事情时，工作质量就会提高：别人会读我的代码，所以最好把代码写好点，
并且我必须解决收到的所有评论，所以我应该尝试尽可能把我的代码写完美点，这样要求修改代码的评论会少点，节省以后的精力。
当代码审查成为日常习惯时，团队将练习每天审查别人代码和接收别人审查代码的反馈。这是增长和改善的关键。

在领英，我们从过去的100万条代码审查中学到了很多东西，并且我们希望从接下来的100万条代码中学到更多。
对代码审查的投入越多，团队进行出色的代码审查的能力就越强，检入的代码质量越高，所构建产品的质量也越高。
高质量的代码审查具有感染力！